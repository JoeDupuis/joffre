<%= render 'scores' %>

<% if Current.player %>
  <% current_team = Current.player.team %>
  <% other_team = current_team == 1 ? 2 : 1 %>
  <% current_team_score = @game.team_total_score(current_team) %>
  <% other_team_score = @game.team_total_score(other_team) %>
  <% did_win = current_team_score >= @game.max_score %>
  <% margin = current_team_score - other_team_score %>

  <div class="round-result">
    <div class="result-title <%= did_win ? 'success' : 'failure' %>">
      <%= did_win ? 'You Win! üèÜ' : 'You Lose üòû' %>
    </div>
    <div class="result-details">
      <div class="result-item">
        <span class="result-label">Final Score:</span>
        <span class="result-value <%= did_win ? 'positive' : '' %>"><%= current_team_score %> - <%= other_team_score %></span>
      </div>
      <div class="result-item">
        <span class="result-label"><%= did_win ? 'Victory' : 'Defeat' %> Margin:</span>
        <span class="result-value <%= did_win ? 'positive' : 'negative' %>"><%= did_win ? '+' : '' %><%= margin %> points</span>
      </div>
    </div>
  </div>
<% else %>
  <% team_1_score = @game.team_total_score(1) %>
  <% team_2_score = @game.team_total_score(2) %>
  <% winning_team = team_1_score >= @game.max_score ? 1 : 2 %>
  <% winning_score = winning_team == 1 ? team_1_score : team_2_score %>
  <% losing_score = winning_team == 1 ? team_2_score : team_1_score %>
  <% margin = winning_score - losing_score %>

  <div class="round-result">
    <div class="result-title success">Team <%= winning_team %> Wins! üèÜ</div>
    <div class="result-details">
      <div class="result-item">
        <span class="result-label">Final Score:</span>
        <span class="result-value positive"><%= winning_score %> - <%= losing_score %></span>
      </div>
      <div class="result-item">
        <span class="result-label">Victory Margin:</span>
        <span class="result-value positive">+<%= margin %> points</span>
      </div>
    </div>
  </div>
<% end %>

<div class="player-hand"></div>
